import tensorflow as tf
from rnn import TRNNConfig
from rnn import ResourceAllocationRNN
import numpy as np

if __name__ == "__main__":

    config = TRNNConfig()
    RNN = ResourceAllocationRNN(config)

observation_0 = [[[0, 0], [1, 1], [2, 2], [3, 3], [4, 4], [5, 5], [6, 6],
               [0, 7], [1, 8], [2, 9], [3, 10], [4, 11], [5, 12], [6, 13],
               [0, 14], [1, 15], [2, 16], [3, 17], [4, 18], [5, 19], [6, 20],
               [0, 21], [1, 22], [2, 23], [3, 24], [4, 25], [5, 26], [6, 27],
               [0, 28], [1, 29], [2, 30], [3, 31], [4, 32], [5, 33], [6, 34],
               [0, 35], [1, 36], [2, 37], [3, 38], [4, 39], [5, 40], [6, 41],
               [0, 42], [1, 43], [2, 44], [3, 45], [4, 46], [5, 47], [6, 48],
               [0, 49], [1, 50], [2, 51], [3, 52], [4, 53], [5, 54], [6, 55],
               [0, 56], [1, 57], [2, 58], [3, 59], [4, 60], [5, 61], [6, 62],
               [0, 63], [1, 64], [2, 65], [3, 66], [4, 67], [5, 68], [6, 69],
               [0, 70], [1, 71], [2, 72], [3, 73], [4, 74], [5, 75], [6, 76],
               [0, 77], [1, 78], [2, 79], [3, 80], [4, 81], [5, 82], [6, 83]]]
observation_1 = [[[6, 0], [5, 1], [4, 2], [3, 3], [2, 4], [1, 5], [0, 6],
                [6, 7], [5, 8], [4, 9], [3, 10], [2, 11], [1, 12], [0, 13],
                [6, 14], [5, 15], [4, 16], [3, 17], [2, 18], [1, 19], [0, 20],
                [6, 21], [5, 22], [4, 23], [3, 24], [2, 25], [1, 26], [0, 27],
                [6, 28], [5, 29], [4, 30], [3, 31], [2, 32], [1, 33], [0, 34],
                [6, 35], [5, 36], [4, 37], [3, 38], [2, 39], [1, 40], [0, 41],
                [6, 42], [5, 43], [4, 44], [3, 45], [2, 46], [1, 47], [0, 48],
                [6, 49], [5, 50], [4, 51], [3, 52], [2, 53], [1, 54], [0, 55],
                [6, 56], [5, 57], [4, 58], [3, 59], [2, 60], [1, 61], [0, 62],
                [6, 63], [5, 64], [4, 65], [3, 66], [2, 67], [1, 68], [0, 69],
                [6, 70], [5, 71], [4, 72], [3, 73], [2, 74], [1, 75], [0, 76],
                [6, 77], [5, 78], [4, 79], [3, 80], [2, 81], [1, 82], [0, 83]]]
observation_2 = [[[0, 0], [0, 1], [0, 2], [0, 3], [0, 4], [0, 5], [0, 6],
               [1, 7], [1, 8], [1, 9], [1, 10], [1, 11], [1, 12], [1, 13],
               [2, 14], [2, 15], [2, 16], [2, 17], [2, 18], [2, 19], [2, 20],
               [3, 21], [3, 22], [3, 23], [3, 24], [3, 25], [3, 26], [3, 27],
               [4, 28], [4, 29], [4, 30], [4, 31], [4, 32], [4, 33], [4, 34],
               [5, 35], [5, 36], [5, 37], [5, 38], [5, 39], [5, 40], [5, 41],
               [6, 42], [6, 43], [6, 44], [6, 45], [6, 46], [6, 47], [6, 48],
               [5, 49], [5, 50], [5, 51], [5, 52], [5, 53], [5, 54], [5, 55],
               [4, 56], [4, 57], [4, 58], [4, 59], [4, 60], [4, 61], [4, 62],
               [3, 63], [3, 64], [3, 65], [3, 66], [3, 67], [3, 68], [3, 69],
               [2, 70], [2, 71], [2, 72], [2, 73], [2, 74], [2, 75], [2, 76],
               [1, 77], [1, 78], [1, 79], [1, 80], [1, 81], [1, 82], [1, 83]]]
observation_3 = [[[6, 0], [6, 1], [6, 2], [6, 3], [6, 4], [6, 5], [6, 6],
                [5, 7], [5, 8], [5, 9], [5, 10], [5, 11], [5, 12], [5, 13],
                [4, 14], [4, 15], [4, 16], [4, 17], [4, 18], [4, 19], [4, 20],
                [3, 21], [3, 22], [3, 23], [3, 24], [3, 25], [3, 26], [3, 27],
                [2, 28], [2, 29], [2, 30], [2, 31], [2, 32], [2, 33], [2, 34],
                [1, 35], [1, 36], [1, 37], [1, 38], [1, 39], [1, 40], [1, 41],
                [0, 42], [0, 43], [0, 44], [0, 45], [0, 46], [0, 47], [0, 48],
                [1, 49], [1, 50], [1, 51], [1, 52], [1, 53], [1, 54], [1, 55],
                [2, 56], [2, 57], [2, 58], [2, 59], [2, 60], [2, 61], [2, 62],
                [3, 63], [3, 64], [3, 65], [3, 66], [3, 67], [3, 68], [3, 69],
                [4, 70], [4, 71], [4, 72], [4, 73], [4, 74], [4, 75], [4, 76],
                [5, 77], [5, 78], [5, 79], [5, 80], [5, 81], [5, 82], [5, 83]]]
observation_4 = [[[0, 0], [2, 1], [4, 2], [6, 3], [1, 4], [3, 5], [5, 6],
               [0, 7], [2, 8], [4, 9], [6, 10], [1, 11], [3, 12], [5, 13],
               [0, 14], [2, 15], [4, 16], [6, 17], [1, 18], [3, 19], [5, 20],
               [0, 21], [2, 22], [4, 23], [6, 24], [1, 25], [3, 26], [5, 27],
               [0, 28], [2, 29], [4, 30], [6, 31], [1, 32], [3, 33], [5, 34],
               [0, 35], [2, 36], [4, 37], [6, 38], [1, 39], [3, 40], [5, 41],
               [0, 42], [2, 43], [4, 44], [6, 45], [1, 46], [3, 47], [5, 48],
               [0, 49], [2, 50], [4, 51], [6, 52], [1, 53], [3, 54], [5, 55],
               [0, 56], [2, 57], [4, 58], [6, 59], [1, 60], [3, 61], [5, 62],
               [0, 63], [2, 64], [4, 65], [6, 66], [1, 67], [3, 68], [5, 69],
               [0, 70], [2, 71], [4, 72], [6, 73], [1, 74], [3, 75], [5, 76],
               [0, 77], [2, 78], [4, 79], [6, 80], [1, 81], [3, 82], [5, 83]]]
observation_5 = [[[0, 0], [1, 1], [2, 2], [3, 3], [4, 4], [5, 5], [6, 6],
               [6, 7], [5, 8], [4, 9], [3, 10], [2, 11], [1, 12], [0, 13],
               [0, 14], [1, 15], [2, 16], [3, 17], [4, 18], [5, 19], [6, 20],
               [6, 21], [5, 22], [4, 23], [3, 24], [2, 25], [1, 26], [0, 27],
               [0, 28], [1, 29], [2, 30], [3, 31], [4, 32], [5, 33], [6, 34],
               [6, 35], [5, 36], [4, 37], [3, 38], [2, 39], [1, 40], [0, 41],
               [0, 42], [1, 43], [2, 44], [3, 45], [4, 46], [5, 47], [6, 48],
               [6, 49], [5, 50], [4, 51], [3, 52], [2, 53], [1, 54], [0, 55],
               [0, 56], [1, 57], [2, 58], [3, 59], [4, 60], [5, 61], [6, 62],
               [6, 63], [5, 64], [4, 65], [3, 66], [2, 67], [1, 68], [0, 69],
               [0, 70], [1, 71], [2, 72], [3, 73], [4, 74], [5, 75], [6, 76],
               [6, 77], [5, 78], [4, 79], [3, 80], [2, 81], [1, 82], [0, 83]]]

observation = [observation_0, observation_1, observation_2, observation_3, observation_4, observation_5]
reward = [10, 30, 40, 20, 10, 30]

for step in range(6):
    print("--------", step, "--------")
    observation_step = observation[step]
    action_step = RNN.choose_action(observation_step)
    reward_step = reward[step]
    s, a, r = RNN.store_transition(observation_step, action_step, reward_step)

discounted_episode_rewards_norm = RNN.learn()
print(discounted_episode_rewards_norm)

print("-------- test --------")
observation_6 = [[[0, 0], [0, 1], [1, 2], [1, 3], [2, 4], [2, 5], [3, 6],
               [3, 7], [4, 8], [4, 9], [5, 10], [5, 11], [6, 12], [6, 13],
               [1, 14], [1, 15], [2, 16], [2, 17], [3, 18], [3, 19], [4, 20],
               [4, 21], [5, 22], [5, 23], [0, 24], [0, 25], [6, 26], [6, 27],
               [2, 28], [2, 29], [3, 30], [3, 31], [4, 32], [4, 33], [5, 34],
               [5, 35], [0, 36], [0, 37], [1, 38], [1, 39], [6, 40], [6, 41],
               [3, 42], [3, 43], [4, 44], [4, 45], [5, 46], [5, 47], [6, 48],
               [6, 49], [2, 50], [2, 51], [1, 52], [1, 53], [0, 54], [0, 55],
               [0, 56], [0, 57], [2, 58], [2, 59], [4, 60], [4, 61], [6, 62],
               [6, 63], [1, 64], [1, 65], [3, 66], [3, 67], [5, 68], [5, 69],
               [0, 70], [1, 71], [2, 72], [3, 73], [4, 74], [5, 75], [6, 76],
               [0, 77], [2, 78], [4, 79], [6, 80], [5, 81], [1, 82], [3, 83]]]
action_6 = RNN.choose_action(observation_6)


